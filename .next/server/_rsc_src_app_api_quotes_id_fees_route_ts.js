"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_src_app_api_quotes_id_fees_route_ts";
exports.ids = ["_rsc_src_app_api_quotes_id_fees_route_ts"];
exports.modules = {

/***/ "(rsc)/./src/app/api/quotes/[id]/fees/route.ts":
/*!***********************************************!*\
  !*** ./src/app/api/quotes/[id]/fees/route.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   recalculateQuoteTotals: () => (/* binding */ recalculateQuoteTotals)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\nconst supabaseUrl = \"https://xgkaviefifbllbmfbyfe.supabase.co\";\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(supabaseUrl, supabaseServiceKey);\n// GET all fees for a quote\nasync function GET(request, { params }) {\n    try {\n        const { id } = await params;\n        const { data: fees, error } = await supabase.from('quote_fees').select(`\n        *,\n        feetypes (\n          id,\n          name\n        ),\n        currencies (\n          id,\n          name\n        )\n      `).eq('quote_id', id).is('deleted_at', null).order('created_at', {\n            ascending: true\n        });\n        if (error) {\n            console.error('Error fetching quote fees:', error);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(fees || []);\n    } catch (error) {\n        console.error('Error in GET /api/quotes/[id]/fees:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\n// POST - Add a fee to a quote\nasync function POST(request, { params }) {\n    try {\n        const { id: quoteId } = await params;\n        const body = await request.json();\n        const { feetype_id, quantity = 1, unit_price_net, comment = '' } = body;\n        if (!feetype_id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'feetype_id is required'\n            }, {\n                status: 400\n            });\n        }\n        if (quantity < 1) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'quantity must be at least 1'\n            }, {\n                status: 400\n            });\n        }\n        // Fetch fee type details\n        const { data: feeType, error: feeError } = await supabase.from('feetypes').select(`\n        *,\n        vat (kulcs),\n        currencies (id, name)\n      `).eq('id', feetype_id).is('deleted_at', null).single();\n        if (feeError || !feeType) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Fee type not found'\n            }, {\n                status: 404\n            });\n        }\n        // Use provided unit price or default from fee type\n        const finalUnitPrice = unit_price_net !== undefined ? unit_price_net : feeType.net_price;\n        // Calculate totals with quantity\n        const vatRate = (feeType.vat?.kulcs || 0) / 100;\n        const totalNet = finalUnitPrice * quantity;\n        const totalVat = totalNet * vatRate;\n        const totalGross = totalNet + totalVat;\n        // Insert fee\n        const { data: newFee, error: insertError } = await supabase.from('quote_fees').insert({\n            quote_id: quoteId,\n            feetype_id: feetype_id,\n            fee_name: feeType.name,\n            quantity: quantity,\n            unit_price_net: finalUnitPrice,\n            vat_rate: vatRate,\n            vat_amount: totalVat,\n            gross_price: totalGross,\n            currency_id: feeType.currency_id,\n            comment: comment\n        }).select().single();\n        if (insertError) {\n            console.error('Error inserting fee:', insertError);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: insertError.message\n            }, {\n                status: 500\n            });\n        }\n        // Recalculate quote totals\n        await recalculateQuoteTotals(quoteId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(newFee, {\n            status: 201\n        });\n    } catch (error) {\n        console.error('Error in POST /api/quotes/[id]/fees:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error'\n        }, {\n            status: 500\n        });\n    }\n}\n// Helper function to recalculate quote totals\nasync function recalculateQuoteTotals(quoteId) {\n    // Get all fees\n    const { data: fees } = await supabase.from('quote_fees').select('unit_price_net, quantity, vat_rate, vat_amount, gross_price').eq('quote_id', quoteId).is('deleted_at', null);\n    // Get all accessories\n    const { data: accessories } = await supabase.from('quote_accessories').select('total_net, total_vat, total_gross').eq('quote_id', quoteId).is('deleted_at', null);\n    // Calculate totals (fees with quantity support)\n    const feesTotalNet = fees?.reduce((sum, f)=>{\n        const totalNet = Number(f.unit_price_net) * Number(f.quantity || 1);\n        return sum + totalNet;\n    }, 0) || 0;\n    const feesTotalVat = fees?.reduce((sum, f)=>{\n        const totalNet = Number(f.unit_price_net) * Number(f.quantity || 1);\n        const totalVat = totalNet * Number(f.vat_rate);\n        return sum + totalVat;\n    }, 0) || 0;\n    const feesTotalGross = feesTotalNet + feesTotalVat;\n    const accessoriesTotalNet = accessories?.reduce((sum, a)=>sum + Number(a.total_net), 0) || 0;\n    const accessoriesTotalVat = accessories?.reduce((sum, a)=>sum + Number(a.total_vat), 0) || 0;\n    const accessoriesTotalGross = accessories?.reduce((sum, a)=>sum + Number(a.total_gross), 0) || 0;\n    // Get current quote to calculate final total with discount\n    const { data: quote } = await supabase.from('quotes').select('total_net, total_vat, total_gross, discount_percent').eq('id', quoteId).single();\n    if (quote) {\n        const discountPercent = Number(quote.discount_percent) / 100;\n        // Calculate subtotal (before discount) - only positive values\n        const materialsGross = Number(quote.total_gross);\n        const feesGrossPositive = Math.max(0, feesTotalGross) // Only positive fees get discount\n        ;\n        const accessoriesGrossPositive = Math.max(0, accessoriesTotalGross) // Only positive accessories get discount\n        ;\n        const subtotalBeforeDiscount = materialsGross + feesGrossPositive + accessoriesGrossPositive;\n        // Calculate discount amount (only on positive values)\n        const discountAmount = subtotalBeforeDiscount * discountPercent;\n        // Add negative fees/accessories (no discount on these)\n        const feesNegative = Math.min(0, feesTotalGross);\n        const accessoriesNegative = Math.min(0, accessoriesTotalGross);\n        // Final total = (positive values with discount) + (negative values without discount)\n        const finalTotalGross = subtotalBeforeDiscount - discountAmount + feesNegative + accessoriesNegative;\n        // Update quote\n        await supabase.from('quotes').update({\n            fees_total_net: feesTotalNet,\n            fees_total_vat: feesTotalVat,\n            fees_total_gross: feesTotalGross,\n            accessories_total_net: accessoriesTotalNet,\n            accessories_total_vat: accessoriesTotalVat,\n            accessories_total_gross: accessoriesTotalGross,\n            final_total_after_discount: finalTotalGross\n        }).eq('id', quoteId);\n    }\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9xdW90ZXMvW2lkXS9mZWVzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQXVEO0FBQ0g7QUFFcEQsTUFBTUUsY0FBY0MsMENBQW9DO0FBQ3hELE1BQU1HLHFCQUFxQkgsUUFBUUMsR0FBRyxDQUFDRyx5QkFBeUI7QUFDaEUsTUFBTUMsV0FBV1AsbUVBQVlBLENBQUNDLGFBQWFJO0FBRTNDLDJCQUEyQjtBQUNwQixlQUFlRyxJQUNwQkMsT0FBb0IsRUFDcEIsRUFBRUMsTUFBTSxFQUF1QztJQUUvQyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxFQUFFLEVBQUUsR0FBRyxNQUFNRDtRQUVyQixNQUFNLEVBQUVFLE1BQU1DLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTVAsU0FDakNRLElBQUksQ0FBQyxjQUNMQyxNQUFNLENBQUMsQ0FBQzs7Ozs7Ozs7OztNQVVULENBQUMsRUFDQUMsRUFBRSxDQUFDLFlBQVlOLElBQ2ZPLEVBQUUsQ0FBQyxjQUFjLE1BQ2pCQyxLQUFLLENBQUMsY0FBYztZQUFFQyxXQUFXO1FBQUs7UUFFekMsSUFBSU4sT0FBTztZQUNUTyxRQUFRUCxLQUFLLENBQUMsOEJBQThCQTtZQUM1QyxPQUFPZixxREFBWUEsQ0FBQ3VCLElBQUksQ0FBQztnQkFBRVIsT0FBT0EsTUFBTVMsT0FBTztZQUFDLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUNuRTtRQUVBLE9BQU96QixxREFBWUEsQ0FBQ3VCLElBQUksQ0FBQ1QsUUFBUSxFQUFFO0lBQ3JDLEVBQUUsT0FBT0MsT0FBTztRQUNkTyxRQUFRUCxLQUFLLENBQUMsdUNBQXVDQTtRQUNyRCxPQUFPZixxREFBWUEsQ0FBQ3VCLElBQUksQ0FDdEI7WUFBRVIsT0FBTztRQUF3QixHQUNqQztZQUFFVSxRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVBLDhCQUE4QjtBQUN2QixlQUFlQyxLQUNwQmhCLE9BQW9CLEVBQ3BCLEVBQUVDLE1BQU0sRUFBdUM7SUFFL0Ms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V0FBVztRQUMvQyxNQUFNSyxvQkFBb0JDLEtBQUtDLEdBQUcsQ0FBQyxHQUFHZCxnQkFBZ0Isa0NBQWtDOztRQUN4RixNQUFNZSwyQkFBMkJGLEtBQUtDLEdBQUcsQ0FBQyxHQUFHUix1QkFBdUIseUNBQXlDOztRQUU3RyxNQUFNVSx5QkFBeUJMLGlCQUFpQkMsb0JBQW9CRztRQUVwRSxzREFBc0Q7UUFDdEQsTUFBTUUsaUJBQWlCRCx5QkFBeUJQO1FBRWhELHVEQUF1RDtRQUN2RCxNQUFNUyxlQUFlTCxLQUFLTSxHQUFHLENBQUMsR0FBR25CO1FBQ2pDLE1BQU1vQixzQkFBc0JQLEtBQUtNLEdBQUcsQ0FBQyxHQUFHYjtRQUV4QyxxRkFBcUY7UUFDckYsTUFBTWUsa0JBQWtCTCx5QkFBeUJDLGlCQUFpQkMsZUFBZUU7UUFFakYsZUFBZTtRQUNmLE1BQU0zRSxTQUNIUSxJQUFJLENBQUMsVUFDTHFFLE1BQU0sQ0FBQztZQUNOQyxnQkFBZ0I3QjtZQUNoQjhCLGdCQUFnQnpCO1lBQ2hCMEIsa0JBQWtCekI7WUFDbEIwQix1QkFBdUJ6QjtZQUN2QjBCLHVCQUF1QnZCO1lBQ3ZCd0IseUJBQXlCdEI7WUFDekJ1Qiw0QkFBNEJSO1FBQzlCLEdBQ0NsRSxFQUFFLENBQUMsTUFBTVM7SUFDZDtBQUNGO0FBRWlDIiwic291cmNlcyI6WyIvVm9sdW1lcy9UNy9lcnBfdHVyaW5vdmFfbmV3L3NyYy9hcHAvYXBpL3F1b3Rlcy9baWRdL2ZlZXMvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJ1xuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCFcbmNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkhXG5jb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VTZXJ2aWNlS2V5KVxuXG4vLyBHRVQgYWxsIGZlZXMgZm9yIGEgcXVvdGVcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogUHJvbWlzZTx7IGlkOiBzdHJpbmcgfT4gfVxuKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBpZCB9ID0gYXdhaXQgcGFyYW1zXG5cbiAgICBjb25zdCB7IGRhdGE6IGZlZXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3F1b3RlX2ZlZXMnKVxuICAgICAgLnNlbGVjdChgXG4gICAgICAgICosXG4gICAgICAgIGZlZXR5cGVzIChcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBuYW1lXG4gICAgICAgICksXG4gICAgICAgIGN1cnJlbmNpZXMgKFxuICAgICAgICAgIGlkLFxuICAgICAgICAgIG5hbWVcbiAgICAgICAgKVxuICAgICAgYClcbiAgICAgIC5lcSgncXVvdGVfaWQnLCBpZClcbiAgICAgIC5pcygnZGVsZXRlZF9hdCcsIG51bGwpXG4gICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBxdW90ZSBmZWVzOicsIGVycm9yKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihmZWVzIHx8IFtdKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIEdFVCAvYXBpL3F1b3Rlcy9baWRdL2ZlZXM6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvcicgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufVxuXG4vLyBQT1NUIC0gQWRkIGEgZmVlIHRvIGEgcXVvdGVcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKFxuICByZXF1ZXN0OiBOZXh0UmVxdWVzdCxcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IFByb21pc2U8eyBpZDogc3RyaW5nIH0+IH1cbikge1xuICB0cnkge1xuICAgIGNvbnN0IHsgaWQ6IHF1b3RlSWQgfSA9IGF3YWl0IHBhcmFtc1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IHsgZmVldHlwZV9pZCwgcXVhbnRpdHkgPSAxLCB1bml0X3ByaWNlX25ldCwgY29tbWVudCA9ICcnIH0gPSBib2R5XG5cbiAgICBpZiAoIWZlZXR5cGVfaWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ2ZlZXR5cGVfaWQgaXMgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGlmIChxdWFudGl0eSA8IDEpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ3F1YW50aXR5IG11c3QgYmUgYXQgbGVhc3QgMScgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gRmV0Y2ggZmVlIHR5cGUgZGV0YWlsc1xuICAgIGNvbnN0IHsgZGF0YTogZmVlVHlwZSwgZXJyb3I6IGZlZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2ZlZXR5cGVzJylcbiAgICAgIC5zZWxlY3QoYFxuICAgICAgICAqLFxuICAgICAgICB2YXQgKGt1bGNzKSxcbiAgICAgICAgY3VycmVuY2llcyAoaWQsIG5hbWUpXG4gICAgICBgKVxuICAgICAgLmVxKCdpZCcsIGZlZXR5cGVfaWQpXG4gICAgICAuaXMoJ2RlbGV0ZWRfYXQnLCBudWxsKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoZmVlRXJyb3IgfHwgIWZlZVR5cGUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0ZlZSB0eXBlIG5vdCBmb3VuZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gVXNlIHByb3ZpZGVkIHVuaXQgcHJpY2Ugb3IgZGVmYXVsdCBmcm9tIGZlZSB0eXBlXG4gICAgY29uc3QgZmluYWxVbml0UHJpY2UgPSB1bml0X3ByaWNlX25ldCAhPT0gdW5kZWZpbmVkID8gdW5pdF9wcmljZV9uZXQgOiBmZWVUeXBlLm5ldF9wcmljZVxuICAgIFxuICAgIC8vIENhbGN1bGF0ZSB0b3RhbHMgd2l0aCBxdWFudGl0eVxuICAgIGNvbnN0IHZhdFJhdGUgPSAoZmVlVHlwZS52YXQ/Lmt1bGNzIHx8IDApIC8gMTAwXG4gICAgY29uc3QgdG90YWxOZXQgPSBmaW5hbFVuaXRQcmljZSAqIHF1YW50aXR5XG4gICAgY29uc3QgdG90YWxWYXQgPSB0b3RhbE5ldCAqIHZhdFJhdGVcbiAgICBjb25zdCB0b3RhbEdyb3NzID0gdG90YWxOZXQgKyB0b3RhbFZhdFxuXG4gICAgLy8gSW5zZXJ0IGZlZVxuICAgIGNvbnN0IHsgZGF0YTogbmV3RmVlLCBlcnJvcjogaW5zZXJ0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgncXVvdGVfZmVlcycpXG4gICAgICAuaW5zZXJ0KHtcbiAgICAgICAgcXVvdGVfaWQ6IHF1b3RlSWQsXG4gICAgICAgIGZlZXR5cGVfaWQ6IGZlZXR5cGVfaWQsXG4gICAgICAgIGZlZV9uYW1lOiBmZWVUeXBlLm5hbWUsXG4gICAgICAgIHF1YW50aXR5OiBxdWFudGl0eSxcbiAgICAgICAgdW5pdF9wcmljZV9uZXQ6IGZpbmFsVW5pdFByaWNlLFxuICAgICAgICB2YXRfcmF0ZTogdmF0UmF0ZSxcbiAgICAgICAgdmF0X2Ftb3VudDogdG90YWxWYXQsXG4gICAgICAgIGdyb3NzX3ByaWNlOiB0b3RhbEdyb3NzLFxuICAgICAgICBjdXJyZW5jeV9pZDogZmVlVHlwZS5jdXJyZW5jeV9pZCxcbiAgICAgICAgY29tbWVudDogY29tbWVudFxuICAgICAgfSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpXG5cbiAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluc2VydGluZyBmZWU6JywgaW5zZXJ0RXJyb3IpXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogaW5zZXJ0RXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pXG4gICAgfVxuXG4gICAgLy8gUmVjYWxjdWxhdGUgcXVvdGUgdG90YWxzXG4gICAgYXdhaXQgcmVjYWxjdWxhdGVRdW90ZVRvdGFscyhxdW90ZUlkKVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKG5ld0ZlZSwgeyBzdGF0dXM6IDIwMSB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIFBPU1QgL2FwaS9xdW90ZXMvW2lkXS9mZWVzOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIHJlY2FsY3VsYXRlIHF1b3RlIHRvdGFsc1xuYXN5bmMgZnVuY3Rpb24gcmVjYWxjdWxhdGVRdW90ZVRvdGFscyhxdW90ZUlkOiBzdHJpbmcpIHtcbiAgLy8gR2V0IGFsbCBmZWVzXG4gIGNvbnN0IHsgZGF0YTogZmVlcyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgncXVvdGVfZmVlcycpXG4gICAgLnNlbGVjdCgndW5pdF9wcmljZV9uZXQsIHF1YW50aXR5LCB2YXRfcmF0ZSwgdmF0X2Ftb3VudCwgZ3Jvc3NfcHJpY2UnKVxuICAgIC5lcSgncXVvdGVfaWQnLCBxdW90ZUlkKVxuICAgIC5pcygnZGVsZXRlZF9hdCcsIG51bGwpXG5cbiAgLy8gR2V0IGFsbCBhY2Nlc3Nvcmllc1xuICBjb25zdCB7IGRhdGE6IGFjY2Vzc29yaWVzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdxdW90ZV9hY2Nlc3NvcmllcycpXG4gICAgLnNlbGVjdCgndG90YWxfbmV0LCB0b3RhbF92YXQsIHRvdGFsX2dyb3NzJylcbiAgICAuZXEoJ3F1b3RlX2lkJywgcXVvdGVJZClcbiAgICAuaXMoJ2RlbGV0ZWRfYXQnLCBudWxsKVxuXG4gIC8vIENhbGN1bGF0ZSB0b3RhbHMgKGZlZXMgd2l0aCBxdWFudGl0eSBzdXBwb3J0KVxuICBjb25zdCBmZWVzVG90YWxOZXQgPSBmZWVzPy5yZWR1Y2UoKHN1bSwgZikgPT4ge1xuICAgIGNvbnN0IHRvdGFsTmV0ID0gTnVtYmVyKGYudW5pdF9wcmljZV9uZXQpICogTnVtYmVyKGYucXVhbnRpdHkgfHwgMSlcbiAgICByZXR1cm4gc3VtICsgdG90YWxOZXRcbiAgfSwgMCkgfHwgMFxuICBcbiAgY29uc3QgZmVlc1RvdGFsVmF0ID0gZmVlcz8ucmVkdWNlKChzdW0sIGYpID0+IHtcbiAgICBjb25zdCB0b3RhbE5ldCA9IE51bWJlcihmLnVuaXRfcHJpY2VfbmV0KSAqIE51bWJlcihmLnF1YW50aXR5IHx8IDEpXG4gICAgY29uc3QgdG90YWxWYXQgPSB0b3RhbE5ldCAqIE51bWJlcihmLnZhdF9yYXRlKVxuICAgIHJldHVybiBzdW0gKyB0b3RhbFZhdFxuICB9LCAwKSB8fCAwXG4gIFxuICBjb25zdCBmZWVzVG90YWxHcm9zcyA9IGZlZXNUb3RhbE5ldCArIGZlZXNUb3RhbFZhdFxuXG4gIGNvbnN0IGFjY2Vzc29yaWVzVG90YWxOZXQgPSBhY2Nlc3Nvcmllcz8ucmVkdWNlKChzdW0sIGEpID0+IHN1bSArIE51bWJlcihhLnRvdGFsX25ldCksIDApIHx8IDBcbiAgY29uc3QgYWNjZXNzb3JpZXNUb3RhbFZhdCA9IGFjY2Vzc29yaWVzPy5yZWR1Y2UoKHN1bSwgYSkgPT4gc3VtICsgTnVtYmVyKGEudG90YWxfdmF0KSwgMCkgfHwgMFxuICBjb25zdCBhY2Nlc3Nvcmllc1RvdGFsR3Jvc3MgPSBhY2Nlc3Nvcmllcz8ucmVkdWNlKChzdW0sIGEpID0+IHN1bSArIE51bWJlcihhLnRvdGFsX2dyb3NzKSwgMCkgfHwgMFxuXG4gIC8vIEdldCBjdXJyZW50IHF1b3RlIHRvIGNhbGN1bGF0ZSBmaW5hbCB0b3RhbCB3aXRoIGRpc2NvdW50XG4gIGNvbnN0IHsgZGF0YTogcXVvdGUgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ3F1b3RlcycpXG4gICAgLnNlbGVjdCgndG90YWxfbmV0LCB0b3RhbF92YXQsIHRvdGFsX2dyb3NzLCBkaXNjb3VudF9wZXJjZW50JylcbiAgICAuZXEoJ2lkJywgcXVvdGVJZClcbiAgICAuc2luZ2xlKClcblxuICBpZiAocXVvdGUpIHtcbiAgICBjb25zdCBkaXNjb3VudFBlcmNlbnQgPSBOdW1iZXIocXVvdGUuZGlzY291bnRfcGVyY2VudCkgLyAxMDBcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgc3VidG90YWwgKGJlZm9yZSBkaXNjb3VudCkgLSBvbmx5IHBvc2l0aXZlIHZhbHVlc1xuICAgIGNvbnN0IG1hdGVyaWFsc0dyb3NzID0gTnVtYmVyKHF1b3RlLnRvdGFsX2dyb3NzKVxuICAgIGNvbnN0IGZlZXNHcm9zc1Bvc2l0aXZlID0gTWF0aC5tYXgoMCwgZmVlc1RvdGFsR3Jvc3MpIC8vIE9ubHkgcG9zaXRpdmUgZmVlcyBnZXQgZGlzY291bnRcbiAgICBjb25zdCBhY2Nlc3Nvcmllc0dyb3NzUG9zaXRpdmUgPSBNYXRoLm1heCgwLCBhY2Nlc3Nvcmllc1RvdGFsR3Jvc3MpIC8vIE9ubHkgcG9zaXRpdmUgYWNjZXNzb3JpZXMgZ2V0IGRpc2NvdW50XG4gICAgXG4gICAgY29uc3Qgc3VidG90YWxCZWZvcmVEaXNjb3VudCA9IG1hdGVyaWFsc0dyb3NzICsgZmVlc0dyb3NzUG9zaXRpdmUgKyBhY2Nlc3Nvcmllc0dyb3NzUG9zaXRpdmVcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgZGlzY291bnQgYW1vdW50IChvbmx5IG9uIHBvc2l0aXZlIHZhbHVlcylcbiAgICBjb25zdCBkaXNjb3VudEFtb3VudCA9IHN1YnRvdGFsQmVmb3JlRGlzY291bnQgKiBkaXNjb3VudFBlcmNlbnRcbiAgICBcbiAgICAvLyBBZGQgbmVnYXRpdmUgZmVlcy9hY2Nlc3NvcmllcyAobm8gZGlzY291bnQgb24gdGhlc2UpXG4gICAgY29uc3QgZmVlc05lZ2F0aXZlID0gTWF0aC5taW4oMCwgZmVlc1RvdGFsR3Jvc3MpXG4gICAgY29uc3QgYWNjZXNzb3JpZXNOZWdhdGl2ZSA9IE1hdGgubWluKDAsIGFjY2Vzc29yaWVzVG90YWxHcm9zcylcbiAgICBcbiAgICAvLyBGaW5hbCB0b3RhbCA9IChwb3NpdGl2ZSB2YWx1ZXMgd2l0aCBkaXNjb3VudCkgKyAobmVnYXRpdmUgdmFsdWVzIHdpdGhvdXQgZGlzY291bnQpXG4gICAgY29uc3QgZmluYWxUb3RhbEdyb3NzID0gc3VidG90YWxCZWZvcmVEaXNjb3VudCAtIGRpc2NvdW50QW1vdW50ICsgZmVlc05lZ2F0aXZlICsgYWNjZXNzb3JpZXNOZWdhdGl2ZVxuXG4gICAgLy8gVXBkYXRlIHF1b3RlXG4gICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdxdW90ZXMnKVxuICAgICAgLnVwZGF0ZSh7XG4gICAgICAgIGZlZXNfdG90YWxfbmV0OiBmZWVzVG90YWxOZXQsXG4gICAgICAgIGZlZXNfdG90YWxfdmF0OiBmZWVzVG90YWxWYXQsXG4gICAgICAgIGZlZXNfdG90YWxfZ3Jvc3M6IGZlZXNUb3RhbEdyb3NzLFxuICAgICAgICBhY2Nlc3Nvcmllc190b3RhbF9uZXQ6IGFjY2Vzc29yaWVzVG90YWxOZXQsXG4gICAgICAgIGFjY2Vzc29yaWVzX3RvdGFsX3ZhdDogYWNjZXNzb3JpZXNUb3RhbFZhdCxcbiAgICAgICAgYWNjZXNzb3JpZXNfdG90YWxfZ3Jvc3M6IGFjY2Vzc29yaWVzVG90YWxHcm9zcyxcbiAgICAgICAgZmluYWxfdG90YWxfYWZ0ZXJfZGlzY291bnQ6IGZpbmFsVG90YWxHcm9zc1xuICAgICAgfSlcbiAgICAgIC5lcSgnaWQnLCBxdW90ZUlkKVxuICB9XG59XG5cbmV4cG9ydCB7IHJlY2FsY3VsYXRlUXVvdGVUb3RhbHMgfVxuXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VTZXJ2aWNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiR0VUIiwicmVxdWVzdCIsInBhcmFtcyIsImlkIiwiZGF0YSIsImZlZXMiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJlcSIsImlzIiwib3JkZXIiLCJhc2NlbmRpbmciLCJjb25zb2xlIiwianNvbiIsIm1lc3NhZ2UiLCJzdGF0dXMiLCJQT1NUIiwicXVvdGVJZCIsImJvZHkiLCJmZWV0eXBlX2lkIiwicXVhbnRpdHkiLCJ1bml0X3ByaWNlX25ldCIsImNvbW1lbnQiLCJmZWVUeXBlIiwiZmVlRXJyb3IiLCJzaW5nbGUiLCJmaW5hbFVuaXRQcmljZSIsInVuZGVmaW5lZCIsIm5ldF9wcmljZSIsInZhdFJhdGUiLCJ2YXQiLCJrdWxjcyIsInRvdGFsTmV0IiwidG90YWxWYXQiLCJ0b3RhbEdyb3NzIiwibmV3RmVlIiwiaW5zZXJ0RXJyb3IiLCJpbnNlcnQiLCJxdW90ZV9pZCIsImZlZV9uYW1lIiwibmFtZSIsInZhdF9yYXRlIiwidmF0X2Ftb3VudCIsImdyb3NzX3ByaWNlIiwiY3VycmVuY3lfaWQiLCJyZWNhbGN1bGF0ZVF1b3RlVG90YWxzIiwiYWNjZXNzb3JpZXMiLCJmZWVzVG90YWxOZXQiLCJyZWR1Y2UiLCJzdW0iLCJmIiwiTnVtYmVyIiwiZmVlc1RvdGFsVmF0IiwiZmVlc1RvdGFsR3Jvc3MiLCJhY2Nlc3Nvcmllc1RvdGFsTmV0IiwiYSIsInRvdGFsX25ldCIsImFjY2Vzc29yaWVzVG90YWxWYXQiLCJ0b3RhbF92YXQiLCJhY2Nlc3Nvcmllc1RvdGFsR3Jvc3MiLCJ0b3RhbF9ncm9zcyIsInF1b3RlIiwiZGlzY291bnRQZXJjZW50IiwiZGlzY291bnRfcGVyY2VudCIsIm1hdGVyaWFsc0dyb3NzIiwiZmVlc0dyb3NzUG9zaXRpdmUiLCJNYXRoIiwibWF4IiwiYWNjZXNzb3JpZXNHcm9zc1Bvc2l0aXZlIiwic3VidG90YWxCZWZvcmVEaXNjb3VudCIsImRpc2NvdW50QW1vdW50IiwiZmVlc05lZ2F0aXZlIiwibWluIiwiYWNjZXNzb3JpZXNOZWdhdGl2ZSIsImZpbmFsVG90YWxHcm9zcyIsInVwZGF0ZSIsImZlZXNfdG90YWxfbmV0IiwiZmVlc190b3RhbF92YXQiLCJmZWVzX3RvdGFsX2dyb3NzIiwiYWNjZXNzb3JpZXNfdG90YWxfbmV0IiwiYWNjZXNzb3JpZXNfdG90YWxfdmF0IiwiYWNjZXNzb3JpZXNfdG90YWxfZ3Jvc3MiLCJmaW5hbF90b3RhbF9hZnRlcl9kaXNjb3VudCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/quotes/[id]/fees/route.ts\n");

/***/ })

};
;