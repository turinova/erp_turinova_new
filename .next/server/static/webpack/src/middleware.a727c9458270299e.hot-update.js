"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(middleware)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var _lib_permissions_server__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/permissions-server */ \"(middleware)/./src/lib/permissions-server.ts\");\n\n\n\nasync function middleware(req) {\n    // Skip middleware for API routes\n    if (req.nextUrl.pathname.startsWith('/api/')) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Skip middleware for static files\n    if (req.nextUrl.pathname.startsWith('/_next/static/') || req.nextUrl.pathname.startsWith('/_next/image/') || req.nextUrl.pathname.includes('.') && !req.nextUrl.pathname.includes('/')) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Performance optimizations\n    const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    // Add performance headers\n    response.headers.set('X-DNS-Prefetch-Control', 'on');\n    response.headers.set('X-Content-Type-Options', 'nosniff');\n    response.headers.set('X-Frame-Options', 'DENY');\n    response.headers.set('X-XSS-Protection', '1; mode=block');\n    // Add cache headers for static assets\n    if (req.nextUrl.pathname.startsWith('/_next/static/')) {\n        response.headers.set('Cache-Control', 'public, max-age=31536000, immutable');\n    }\n    // Add cache headers for brand pages\n    if (req.nextUrl.pathname.startsWith('/brands/')) {\n        response.headers.set('Cache-Control', 'public, max-age=60, s-maxage=60');\n    }\n    // Define public routes that don't require authentication\n    const publicRoutes = [\n        '/',\n        '/home',\n        '/login'\n    ];\n    const isPublicRoute = publicRoutes.includes(req.nextUrl.pathname);\n    // Skip authentication for public routes\n    if (isPublicRoute) {\n        console.log('Middleware - Public route:', req.nextUrl.pathname);\n        return response;\n    }\n    // Enable authentication for all other routes\n    const supabase = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(\"https://xgkaviefifbllbmfbyfe.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhna2F2aWVmaWZibGxibWZieWZlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcxNDYxNTEsImV4cCI6MjA3MjcyMjE1MX0.EQFv5-iHscXMhU73oV7f90xmB8g8gr3YJ_-4ROQJ-AY\", {\n        cookies: {\n            getAll () {\n                return req.cookies.getAll();\n            },\n            setAll (cookiesToSet) {\n                cookiesToSet.forEach(({ name, value, options })=>{\n                    req.cookies.set(name, value);\n                    response.cookies.set(name, value, options);\n                });\n            }\n        }\n    });\n    // Try to get session with better error handling\n    let session = null;\n    try {\n        // First try to get session from cookies\n        const { data: { session: sessionData }, error } = await supabase.auth.getSession();\n        if (error) {\n            console.log('Middleware - Session error:', error.message);\n        } else {\n            session = sessionData;\n        }\n        // If no session found, try to get user directly\n        if (!session) {\n            const { data: { user }, error: userError } = await supabase.auth.getUser();\n            if (userError) {\n                console.log('Middleware - User error:', userError.message);\n            } else if (user) {\n                console.log('Middleware - Found user without session:', user.email);\n                // Create a minimal session object\n                session = {\n                    user\n                };\n            }\n        }\n    } catch (error) {\n        console.log('Middleware - Session exception:', error);\n    }\n    console.log('Middleware - Path:', req.nextUrl.pathname, 'Session:', !!session, 'User:', session?.user?.email);\n    console.log('Middleware - Cookies:', req.cookies.getAll().map((c)=>c.name).join(', '));\n    // If user is not signed in and the current path is not /login, redirect to /login\n    if (!session && req.nextUrl.pathname !== '/login') {\n        console.log('Middleware - Redirecting to login (no session)');\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/login', req.url));\n    }\n    // If user is signed in and the current path is /login or /, redirect to /home\n    if (session && (req.nextUrl.pathname === '/login' || req.nextUrl.pathname === '/')) {\n        console.log('Middleware - Redirecting to home (user signed in)');\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/home', req.url));\n    }\n    // Check page permissions for authenticated users\n    if (session && session.user) {\n        try {\n            const hasPermission = await (0,_lib_permissions_server__WEBPACK_IMPORTED_MODULE_2__.hasPagePermission)(session.user.id, req.nextUrl.pathname);\n            if (!hasPermission) {\n                console.log('Middleware - Access denied for:', req.nextUrl.pathname, 'User:', session.user.email);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/home', req.url));\n            }\n            console.log('Middleware - Access granted for:', req.nextUrl.pathname, 'User:', session.user.email);\n        } catch (error) {\n            console.error('Middleware - Permission check error:', error);\n            // Fail-closed: redirect to home on permission check error\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/home', req.url));\n        }\n    }\n    return response;\n}\nconst config = {\n    matcher: [\n        /*\n     * Match all request paths except for the ones starting with:\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public folder\n     */ '/((?!_next|favicon.ico|.*\\\\.(?:svg|png|jpg|jpeg|gif|webp|css|js|woff|woff2|ttf|eot)$).*)'\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFNVSxnQkFBZ0IsTUFBTTdDLDBFQUFpQkEsQ0FBQzRCLFFBQVFPLElBQUksQ0FBQ1csRUFBRSxFQUFFNUMsSUFBSUMsT0FBTyxDQUFDQyxRQUFRO1lBRW5GLElBQUksQ0FBQ3lDLGVBQWU7Z0JBQ2xCaEMsUUFBUUMsR0FBRyxDQUFDLG1DQUFtQ1osSUFBSUMsT0FBTyxDQUFDQyxRQUFRLEVBQUUsU0FBU3dCLFFBQVFPLElBQUksQ0FBQ0csS0FBSztnQkFDaEcsT0FBT3hDLHFEQUFZQSxDQUFDNEMsUUFBUSxDQUFDLElBQUlDLElBQUksU0FBU3pDLElBQUkwQyxHQUFHO1lBQ3ZEO1lBRUEvQixRQUFRQyxHQUFHLENBQUMsb0NBQW9DWixJQUFJQyxPQUFPLENBQUNDLFFBQVEsRUFBRSxTQUFTd0IsUUFBUU8sSUFBSSxDQUFDRyxLQUFLO1FBQ25HLEVBQUUsT0FBT1AsT0FBTztZQUNkbEIsUUFBUWtCLEtBQUssQ0FBQyx3Q0FBd0NBO1lBQ3RELDBEQUEwRDtZQUMxRCxPQUFPakMscURBQVlBLENBQUM0QyxRQUFRLENBQUMsSUFBSUMsSUFBSSxTQUFTekMsSUFBSTBDLEdBQUc7UUFDdkQ7SUFDRjtJQUVBLE9BQU9wQztBQUNUO0FBRU8sTUFBTXVDLFNBQVM7SUFDcEJDLFNBQVM7UUFDUDs7Ozs7O0tBTUMsR0FDRDtLQUNEO0FBQ0gsRUFBQyIsInNvdXJjZXMiOlsiL1ZvbHVtZXMvVDcvZXJwX3R1cmlub3ZhX25ldy9zcmMvbWlkZGxld2FyZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB0eXBlIHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcidcblxuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3NzcidcbmltcG9ydCB7IGhhc1BhZ2VQZXJtaXNzaW9uIH0gZnJvbSAnQC9saWIvcGVybWlzc2lvbnMtc2VydmVyJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZShyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIC8vIFNraXAgbWlkZGxld2FyZSBmb3IgQVBJIHJvdXRlc1xuICBpZiAocmVxLm5leHRVcmwucGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS8nKSkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpXG4gIH1cblxuICAvLyBTa2lwIG1pZGRsZXdhcmUgZm9yIHN0YXRpYyBmaWxlc1xuICBpZiAocmVxLm5leHRVcmwucGF0aG5hbWUuc3RhcnRzV2l0aCgnL19uZXh0L3N0YXRpYy8nKSB8fCBcbiAgICAgIHJlcS5uZXh0VXJsLnBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9fbmV4dC9pbWFnZS8nKSB8fFxuICAgICAgcmVxLm5leHRVcmwucGF0aG5hbWUuaW5jbHVkZXMoJy4nKSAmJiAhcmVxLm5leHRVcmwucGF0aG5hbWUuaW5jbHVkZXMoJy8nKSkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpXG4gIH1cblxuICAvLyBQZXJmb3JtYW5jZSBvcHRpbWl6YXRpb25zXG4gIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLm5leHQoKVxuICBcbiAgLy8gQWRkIHBlcmZvcm1hbmNlIGhlYWRlcnNcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1gtRE5TLVByZWZldGNoLUNvbnRyb2wnLCAnb24nKVxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1Db250ZW50LVR5cGUtT3B0aW9ucycsICdub3NuaWZmJylcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1gtRnJhbWUtT3B0aW9ucycsICdERU5ZJylcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1gtWFNTLVByb3RlY3Rpb24nLCAnMTsgbW9kZT1ibG9jaycpXG4gIFxuICAvLyBBZGQgY2FjaGUgaGVhZGVycyBmb3Igc3RhdGljIGFzc2V0c1xuICBpZiAocmVxLm5leHRVcmwucGF0aG5hbWUuc3RhcnRzV2l0aCgnL19uZXh0L3N0YXRpYy8nKSkge1xuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdDYWNoZS1Db250cm9sJywgJ3B1YmxpYywgbWF4LWFnZT0zMTUzNjAwMCwgaW1tdXRhYmxlJylcbiAgfVxuICBcbiAgLy8gQWRkIGNhY2hlIGhlYWRlcnMgZm9yIGJyYW5kIHBhZ2VzXG4gIGlmIChyZXEubmV4dFVybC5wYXRobmFtZS5zdGFydHNXaXRoKCcvYnJhbmRzLycpKSB7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0NhY2hlLUNvbnRyb2wnLCAncHVibGljLCBtYXgtYWdlPTYwLCBzLW1heGFnZT02MCcpXG4gIH1cbiAgXG4gIC8vIERlZmluZSBwdWJsaWMgcm91dGVzIHRoYXQgZG9uJ3QgcmVxdWlyZSBhdXRoZW50aWNhdGlvblxuICBjb25zdCBwdWJsaWNSb3V0ZXMgPSBbJy8nLCAnL2hvbWUnLCAnL2xvZ2luJ11cbiAgY29uc3QgaXNQdWJsaWNSb3V0ZSA9IHB1YmxpY1JvdXRlcy5pbmNsdWRlcyhyZXEubmV4dFVybC5wYXRobmFtZSlcbiAgXG4gIC8vIFNraXAgYXV0aGVudGljYXRpb24gZm9yIHB1YmxpYyByb3V0ZXNcbiAgaWYgKGlzUHVibGljUm91dGUpIHtcbiAgICBjb25zb2xlLmxvZygnTWlkZGxld2FyZSAtIFB1YmxpYyByb3V0ZTonLCByZXEubmV4dFVybC5wYXRobmFtZSlcbiAgICByZXR1cm4gcmVzcG9uc2VcbiAgfVxuXG4gIC8vIEVuYWJsZSBhdXRoZW50aWNhdGlvbiBmb3IgYWxsIG90aGVyIHJvdXRlc1xuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZVNlcnZlckNsaWVudChcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwhLFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZISxcbiAgICB7XG4gICAgICBjb29raWVzOiB7XG4gICAgICAgIGdldEFsbCgpIHtcbiAgICAgICAgICByZXR1cm4gcmVxLmNvb2tpZXMuZ2V0QWxsKClcbiAgICAgICAgfSxcbiAgICAgICAgc2V0QWxsKGNvb2tpZXNUb1NldCkge1xuICAgICAgICAgIGNvb2tpZXNUb1NldC5mb3JFYWNoKCh7IG5hbWUsIHZhbHVlLCBvcHRpb25zIH0pID0+IHtcbiAgICAgICAgICAgIHJlcS5jb29raWVzLnNldChuYW1lLCB2YWx1ZSlcbiAgICAgICAgICAgIHJlc3BvbnNlLmNvb2tpZXMuc2V0KG5hbWUsIHZhbHVlLCBvcHRpb25zKVxuICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH1cbiAgKVxuXG4gIC8vIFRyeSB0byBnZXQgc2Vzc2lvbiB3aXRoIGJldHRlciBlcnJvciBoYW5kbGluZ1xuICBsZXQgc2Vzc2lvbiA9IG51bGxcbiAgdHJ5IHtcbiAgICAvLyBGaXJzdCB0cnkgdG8gZ2V0IHNlc3Npb24gZnJvbSBjb29raWVzXG4gICAgY29uc3QgeyBkYXRhOiB7IHNlc3Npb246IHNlc3Npb25EYXRhIH0sIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKVxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coJ01pZGRsZXdhcmUgLSBTZXNzaW9uIGVycm9yOicsIGVycm9yLm1lc3NhZ2UpXG4gICAgfSBlbHNlIHtcbiAgICAgIHNlc3Npb24gPSBzZXNzaW9uRGF0YVxuICAgIH1cbiAgICBcbiAgICAvLyBJZiBubyBzZXNzaW9uIGZvdW5kLCB0cnkgdG8gZ2V0IHVzZXIgZGlyZWN0bHlcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0sIGVycm9yOiB1c2VyRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpXG4gICAgICBpZiAodXNlckVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdNaWRkbGV3YXJlIC0gVXNlciBlcnJvcjonLCB1c2VyRXJyb3IubWVzc2FnZSlcbiAgICAgIH0gZWxzZSBpZiAodXNlcikge1xuICAgICAgICBjb25zb2xlLmxvZygnTWlkZGxld2FyZSAtIEZvdW5kIHVzZXIgd2l0aG91dCBzZXNzaW9uOicsIHVzZXIuZW1haWwpXG4gICAgICAgIC8vIENyZWF0ZSBhIG1pbmltYWwgc2Vzc2lvbiBvYmplY3RcbiAgICAgICAgc2Vzc2lvbiA9IHsgdXNlciB9XG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKCdNaWRkbGV3YXJlIC0gU2Vzc2lvbiBleGNlcHRpb246JywgZXJyb3IpXG4gIH1cblxuICBjb25zb2xlLmxvZygnTWlkZGxld2FyZSAtIFBhdGg6JywgcmVxLm5leHRVcmwucGF0aG5hbWUsICdTZXNzaW9uOicsICEhc2Vzc2lvbiwgJ1VzZXI6Jywgc2Vzc2lvbj8udXNlcj8uZW1haWwpXG4gIGNvbnNvbGUubG9nKCdNaWRkbGV3YXJlIC0gQ29va2llczonLCByZXEuY29va2llcy5nZXRBbGwoKS5tYXAoYyA9PiBjLm5hbWUpLmpvaW4oJywgJykpXG5cbiAgLy8gSWYgdXNlciBpcyBub3Qgc2lnbmVkIGluIGFuZCB0aGUgY3VycmVudCBwYXRoIGlzIG5vdCAvbG9naW4sIHJlZGlyZWN0IHRvIC9sb2dpblxuICBpZiAoIXNlc3Npb24gJiYgcmVxLm5leHRVcmwucGF0aG5hbWUgIT09ICcvbG9naW4nKSB7XG4gICAgY29uc29sZS5sb2coJ01pZGRsZXdhcmUgLSBSZWRpcmVjdGluZyB0byBsb2dpbiAobm8gc2Vzc2lvbiknKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2xvZ2luJywgcmVxLnVybCkpXG4gIH1cblxuICAvLyBJZiB1c2VyIGlzIHNpZ25lZCBpbiBhbmQgdGhlIGN1cnJlbnQgcGF0aCBpcyAvbG9naW4gb3IgLywgcmVkaXJlY3QgdG8gL2hvbWVcbiAgaWYgKHNlc3Npb24gJiYgKHJlcS5uZXh0VXJsLnBhdGhuYW1lID09PSAnL2xvZ2luJyB8fCByZXEubmV4dFVybC5wYXRobmFtZSA9PT0gJy8nKSkge1xuICAgIGNvbnNvbGUubG9nKCdNaWRkbGV3YXJlIC0gUmVkaXJlY3RpbmcgdG8gaG9tZSAodXNlciBzaWduZWQgaW4pJylcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9ob21lJywgcmVxLnVybCkpXG4gIH1cblxuICAvLyBDaGVjayBwYWdlIHBlcm1pc3Npb25zIGZvciBhdXRoZW50aWNhdGVkIHVzZXJzXG4gIGlmIChzZXNzaW9uICYmIHNlc3Npb24udXNlcikge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBoYXNQZXJtaXNzaW9uID0gYXdhaXQgaGFzUGFnZVBlcm1pc3Npb24oc2Vzc2lvbi51c2VyLmlkLCByZXEubmV4dFVybC5wYXRobmFtZSlcbiAgICAgIFxuICAgICAgaWYgKCFoYXNQZXJtaXNzaW9uKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdNaWRkbGV3YXJlIC0gQWNjZXNzIGRlbmllZCBmb3I6JywgcmVxLm5leHRVcmwucGF0aG5hbWUsICdVc2VyOicsIHNlc3Npb24udXNlci5lbWFpbClcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvaG9tZScsIHJlcS51cmwpKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnTWlkZGxld2FyZSAtIEFjY2VzcyBncmFudGVkIGZvcjonLCByZXEubmV4dFVybC5wYXRobmFtZSwgJ1VzZXI6Jywgc2Vzc2lvbi51c2VyLmVtYWlsKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdNaWRkbGV3YXJlIC0gUGVybWlzc2lvbiBjaGVjayBlcnJvcjonLCBlcnJvcilcbiAgICAgIC8vIEZhaWwtY2xvc2VkOiByZWRpcmVjdCB0byBob21lIG9uIHBlcm1pc3Npb24gY2hlY2sgZXJyb3JcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2hvbWUnLCByZXEudXJsKSlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzcG9uc2Vcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1xuICAgIC8qXG4gICAgICogTWF0Y2ggYWxsIHJlcXVlc3QgcGF0aHMgZXhjZXB0IGZvciB0aGUgb25lcyBzdGFydGluZyB3aXRoOlxuICAgICAqIC0gX25leHQvc3RhdGljIChzdGF0aWMgZmlsZXMpXG4gICAgICogLSBfbmV4dC9pbWFnZSAoaW1hZ2Ugb3B0aW1pemF0aW9uIGZpbGVzKVxuICAgICAqIC0gZmF2aWNvbi5pY28gKGZhdmljb24gZmlsZSlcbiAgICAgKiAtIHB1YmxpYyBmb2xkZXJcbiAgICAgKi9cbiAgICAnLygoPyFfbmV4dHxmYXZpY29uLmljb3wuKlxcXFwuKD86c3ZnfHBuZ3xqcGd8anBlZ3xnaWZ8d2VicHxjc3N8anN8d29mZnx3b2ZmMnx0dGZ8ZW90KSQpLiopJyxcbiAgXSxcbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJoYXNQYWdlUGVybWlzc2lvbiIsIm1pZGRsZXdhcmUiLCJyZXEiLCJuZXh0VXJsIiwicGF0aG5hbWUiLCJzdGFydHNXaXRoIiwibmV4dCIsImluY2x1ZGVzIiwicmVzcG9uc2UiLCJoZWFkZXJzIiwic2V0IiwicHVibGljUm91dGVzIiwiaXNQdWJsaWNSb3V0ZSIsImNvbnNvbGUiLCJsb2ciLCJzdXBhYmFzZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsImNvb2tpZXMiLCJnZXRBbGwiLCJzZXRBbGwiLCJjb29raWVzVG9TZXQiLCJmb3JFYWNoIiwibmFtZSIsInZhbHVlIiwib3B0aW9ucyIsInNlc3Npb24iLCJkYXRhIiwic2Vzc2lvbkRhdGEiLCJlcnJvciIsImF1dGgiLCJnZXRTZXNzaW9uIiwibWVzc2FnZSIsInVzZXIiLCJ1c2VyRXJyb3IiLCJnZXRVc2VyIiwiZW1haWwiLCJtYXAiLCJjIiwiam9pbiIsInJlZGlyZWN0IiwiVVJMIiwidXJsIiwiaGFzUGVybWlzc2lvbiIsImlkIiwiY29uZmlnIiwibWF0Y2hlciJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});